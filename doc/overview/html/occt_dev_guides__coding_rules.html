<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open CASCADE Technology: Coding Rules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('occt_dev_guides__coding_rules.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Coding Rules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#occt_coding_rules_1">Introduction</a><ul><li class="level2"><a href="#occt_coding_rules_1_1">Scope of the document</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_coding_rules_2">Naming Conventions</a><ul><li class="level2"><a href="#occt_coding_rules_2_1">General naming rules</a></li>
<li class="level2"><a href="#occt_coding_rules_2_2">Names of development units</a></li>
<li class="level2"><a href="#occt_coding_rules_2_3">Names of variables</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_coding_rules_3">Formatting rules</a></li>
<li class="level1"><a href="#occt_coding_rules_4">Documentation rules</a></li>
<li class="level1"><a href="#occt_coding_rules_5">Application design</a></li>
<li class="level1"><a href="#occt_coding_rules_6">General C/C++ rules</a></li>
<li class="level1"><a href="#occt_coding_rules_7">Portability issues</a></li>
<li class="level1"><a href="#occt_coding_rules_8">Stability issues</a></li>
<li class="level1"><a href="#occt_coding_rules_9">Performance issues</a></li>
<li class="level1"><a href="#occt_coding_rules_10">Draw Harness command</a></li>
<li class="level1"><a href="#occt_coding_rules_11">Examples</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="occt_coding_rules_1"></a>
Introduction</h1>
<p>The purpose of this document is to define a common programming style for Open CASCADE Technology.</p>
<p>The common style facilitates understanding and maintaining a code developed cooperatively by several programmers. In addition, it enables construction of tools that incorporate knowledge of these standards to help in the programming.</p>
<p>OCCT programming style follows common and appropriate best practices, so some guidelines have been excerpted from the public domain.</p>
<p>The guide can be improved in the future as new ideas and enhancements are added.</p>
<h2><a class="anchor" id="occt_coding_rules_1_1"></a>
Scope of the document</h2>
<p>Rules in this document refer to C++ code. However, with minor exceptions due to language restrictions, they are applicable to any sources in Open CASCADE Technology framework, including:</p><ul>
<li>C/C++</li>
<li>GLSL programs</li>
<li>OpenCL kernels</li>
<li>TCL scripts and test cases</li>
</ul>
<h1><a class="anchor" id="occt_coding_rules_2"></a>
Naming Conventions</h1>
<h2><a class="anchor" id="occt_coding_rules_2_1"></a>
General naming rules</h2>
<p>The names considered in this section mainly refer to the interface of Open CASCADE Technology libraries or source code itself.</p>
<h3>International language [MANDATORY]</h3>
<p>Open CASCADE Technology is an open source platform available for an international community, thus all names need to be composed of English words or their abbreviations.</p>
<h3>Meaningful names</h3>
<p>Names should be meaningful or, at least, contain a meaningful part. To better understand this requirement, let us examine the existing names of toolkits, packages, classes and methods:</p><ul>
<li>Packages containing words <em>Geom</em> or <em>Geom2d</em> in their names are related to geometrical data and operations.</li>
<li>Packages containing words <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s.html">TopoDS</a></em> or <em>BRep</em> in their names are related to topological data and operations.</li>
<li>Packages ending with <em>...Test</em> define <a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Harness plugins.</li>
<li>Methods starting with <em>Get...</em> and <em>Set...</em> are usually responsible for correspondingly retrieving and storing data.</li>
</ul>
<h3>Related names</h3>
<p>Names related to a logically connected functionality should have the same prefix (start with the same letters) or, at least, have any other common part. For example, method <em>GetCoord</em> returns a triple of real values and is defined for directions, vectors and points. The logical connection is obvious.</p>
<h3>Camel Case style</h3>
<p>Camel Case style is preferred for names. For example:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> awidthofbox;  <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> width_of_box; <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aWidthOfBox;  <span class="comment">// this is OK</span></div></div><!-- fragment --><h2><a class="anchor" id="occt_coding_rules_2_2"></a>
Names of development units</h2>
<p>Usually a unit (e.g. a package) is a set of classes, methods, enumerations or any other sources implementing a common functionality, which is self-contained and independent from other parts of the library.</p>
<h3>No underscores in unit names [MANDATORY]</h3>
<p>Names of units should not contain underscores, unless the use of underscores is allowed explicitly.</p>
<h3>File name extensions [MANDATORY]</h3>
<p>The following extensions should be used for source files, depending on their type:</p>
<ul>
<li><em>.cxx</em> &ndash; C++ source files</li>
<li><em>.hxx</em> &ndash; C++ header files</li>
<li><em>.lxx</em> &ndash; additional headers containing definitions of inline methods and auxiliary code</li>
</ul>
<p>Note that .lxx files should be avoided in most cases - inline method should be placed in header file instead.</p>
<h3>Prefix for toolkit names [MANDATORY]</h3>
<p>Toolkit names are prefixed by <em>TK</em>, followed by a meaningful part of the name explaining the domain of functionality covered by the toolkit (e.g. <em>TKOpenGl</em>).</p>
<h3>Names of classes</h3>
<p>Usually the names of source files located in a unit start from the unit name separated from the other part of the file name by underscore "_".</p>
<p>Thus, the names of files containing sources of C++ classes that belong to a package are constructed according to the following template:</p>
<div class="fragment"><div class="line">&lt;package-name&gt;_&lt;class-name&gt;.cxx (or .hxx)</div></div><!-- fragment --><p>For example, file <em>Adaptor2d_Curve2d.cxx</em> belongs to the package <em>Adaptor2d</em></p>
<p>Files that contain sources related to the whole unit are called by the unit name with appropriate extension.</p>
<h3>Names of functions</h3>
<p>The term <b>function</b> here is defined as:</p><ul>
<li>Any class method</li>
<li>Any package method</li>
<li>Any non-member procedure or function</li>
</ul>
<p>It is preferred to start names of public methods from an upper case character and to start names of protected and private methods from a lower case character.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyPackage_MyClass</div><div class="line">{</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> Value() <span class="keyword">const</span>;</div><div class="line">  <span class="keywordtype">void</span>             SetValue (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> theValue);</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> setIntegerValue (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> theValue);</div><div class="line"></div><div class="line">};</div></div><!-- fragment --><h2><a class="anchor" id="occt_coding_rules_2_3"></a>
Names of variables</h2>
<p>There are several rules that describe currently accepted practices for naming variables.</p>
<h3>Naming of variables</h3>
<p>Name of a variable should not conflict with the existing or possible global names (for packages, macros, functions, global variables, etc.).</p>
<p>The name of a variable should not start with an underscore.</p>
<p>See the following examples:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> Elapsed_Time = 0; <span class="comment">// this is bad - possible class   name</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp.html">gp</a> = 0;           <span class="comment">// this is bad - existing package name</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aGp = 0;          <span class="comment">// this is OK</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> _KERNEL = 0;      <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> THE_KERNEL = 0;   <span class="comment">// this is OK</span></div></div><!-- fragment --><h3>Names of function parameters</h3>
<p>The name of a function (procedure, class method) parameter should start with prefix <em>the</em> followed by the meaningful part of the name starting with a capital letter.</p>
<p>See the following examples:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Package_MyClass::MyFunction (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp___pnt.html">gp_Pnt</a>&amp; p);        <span class="comment">// this is bad</span></div><div class="line"><span class="keywordtype">void</span> Package_MyClass::MyFunction (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp___pnt.html">gp_Pnt</a>&amp; theP);     <span class="comment">// this is OK</span></div><div class="line"><span class="keywordtype">void</span> Package_MyClass::MyFunction (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp___pnt.html">gp_Pnt</a>&amp; thePoint); <span class="comment">// this is preferred</span></div></div><!-- fragment --><h3>Names of class member variables</h3>
<p>The name of a class member variable should start with prefix <em>my</em> followed by the meaningful of the name starting with a capital letter.</p>
<p>See the following examples:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> counter;   <span class="comment">// This is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> myC;       <span class="comment">// This is OK</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> myCounter; <span class="comment">// This is preferred</span></div></div><!-- fragment --><h3>Names of global variables</h3>
<p>It is strongly recommended to avoid defining any global variables. However, as soon as a global variable is necessary, its name should be prefixed by the name of a class or a package where it is defined followed with <em>_my</em>.</p>
<p>See the following examples:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> MyPackage_myGlobalVariable = 0;</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> MyPackage_MyClass_myGlobalVariable = 0;</div></div><!-- fragment --><p>Static constants within the file should be written in upper-case and begin with prefix <em>THE_</em>: </p><div class="fragment"><div class="line"><span class="keyword">namespace</span></div><div class="line">{</div><div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a> THE_CONSTANT_COEF = 3.14;</div><div class="line">};</div></div><!-- fragment --><h3>Names of local variables</h3>
<p>The name of a local variable should be distinguishable from the name of a function parameter, a class member variable and a global variable.</p>
<p>It is preferred to prefix local variable names with <em>a</em> and <em>an</em> (or <em>is</em>, <em>to</em> and <em>has</em> for Boolean variables).</p>
<p>See the following example:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> theI;    <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> i;       <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> index;   <span class="comment">// this is bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anIndex; <span class="comment">// this is OK</span></div></div><!-- fragment --><h3>Avoid dummy names</h3>
<p>Avoid dummy names, such as <em>i, j, k</em>. Such names are meaningless and easy to mix up.</p>
<p>The code becomes more and more complicated when such dummy names are used there multiple times with different meanings, or in cycles with different iteration ranges, etc.</p>
<p>See the following examples for preferred style:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Average (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a>** theArray,</div><div class="line">              <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>      theRowsNb,</div><div class="line">              <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>      theRowLen,</div><div class="line">              <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a>&amp;        theResult)</div><div class="line">{</div><div class="line">  theResult = 0.0;</div><div class="line">  <span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aRow = 0; aRow &lt; aRowsNb; ++aRow)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aCol = 0; aCol &lt; aRowLen; ++aCol)</div><div class="line">    {</div><div class="line">      theResult += theArray[aRow][aCol];</div><div class="line">    }</div><div class="line">    theResult /= <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a>(aRowsNb * aRowLen);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="occt_coding_rules_3"></a>
Formatting rules</h1>
<p>To improve the open source readability and, consequently, maintainability, the following set of rules is applied.</p>
<h3>International language [MANDATORY]</h3>
<p>All comments in all sources must be in English.</p>
<h3>Line length</h3>
<p>Try to stay within the limit of 120 characters per line in all sources.</p>
<h3>C++ style comments</h3>
<p>Prefer C++ style comments in C++ sources.</p>
<h3>Commenting out unused code</h3>
<p>Delete unused code instead of commenting it or using #define.</p>
<h3>Indentation in sources [MANDATORY]</h3>
<p>Indentation in all sources should be set to two space characters. Use of tabulation characters for indentation is disallowed.</p>
<h3>Separating spaces</h3>
<p>Punctuation rules follow the rules of the English language.</p><ul>
<li>C/C++ reserved words, commas, colons and semicolons should be followed by a space character if they are not at the end of a line.</li>
<li>There should be no space characters after '(' and before ')'. Closing and opening brackets should be separated by a space character.</li>
<li>For better readability it is also recommended to surround conventional operators by a space character. Examples:</li>
</ul>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (<span class="keyword">true</span>)                            <span class="comment">// NOT: while( true ) ...</span></div><div class="line">{</div><div class="line">  DoSomething (theA, theB, theC, theD); <span class="comment">// NOT: DoSomething(theA,theB,theC,theD);</span></div><div class="line">}</div><div class="line"><span class="keywordflow">for</span> (anIter = 0; anIter &lt; 10; ++anIter) <span class="comment">// NOT: for (anIter=0;anIter&lt;10;++anIter){</span></div><div class="line">{</div><div class="line">  theA = (theB + theC) * theD;          <span class="comment">// NOT: theA=(theB+theC)*theD</span></div><div class="line">}</div></div><!-- fragment --><h3>Declaration of pointers and references</h3>
<p>In declarations of simple pointers and references put asterisk (*) or ampersand (&amp;) right after the type without extra space.</p>
<p>Since declaration of several variables with mixed pointer types contrudicts this rule, it should be avoided. Instead, declare each variable independently with fully qualified type.</p>
<p>Examples:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>   *theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> *  theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>*   theVariable;      <span class="comment">// this is OK</span></div><div class="line"></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>  *&amp;theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> *&amp; theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>*&amp;  theVariable;      <span class="comment">// this is OK</span></div><div class="line"></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>  **theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> ** theVariable;      <span class="comment">// not recommended</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>**  theVariable;      <span class="comment">// this is OK</span></div><div class="line"></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> *theA, theB, **theC; <span class="comment">// not recommended (declare each variable independently)</span></div></div><!-- fragment --><h3>Separate logical blocks</h3>
<p>Separate logical blocks of code with one blank line and comments.</p>
<p>See the following example:</p>
<div class="fragment"><div class="line"><span class="comment">// check arguments</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anArgsNb = argCount();</div><div class="line"><span class="keywordflow">if</span> (anArgsNb &lt; 3 || isSmthInvalid)</div><div class="line">{</div><div class="line">  <span class="keywordflow">return</span> THE_ARG_INVALID;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// read and check header</span></div><div class="line">...</div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">// do our job</span></div><div class="line">...</div><div class="line">...</div></div><!-- fragment --><p>Notice that multiple blank lines should be avoided.</p>
<h3>Separate function bodies [MANDATORY]</h3>
<p>Use function descriptive blocks to separate function bodies from each other. Each descriptive block should contain at least a function name and purpose description.</p>
<p>See the following example:</p>
<div class="fragment"><div class="line"><span class="comment">// =======================================================================</span></div><div class="line"><span class="comment">// function : TellMeSmthGood</span></div><div class="line"><span class="comment">// purpose  : Gives me good news</span></div><div class="line"><span class="comment">// =======================================================================</span></div><div class="line"><span class="keywordtype">void</span> TellMeSmthGood()</div><div class="line">{</div><div class="line">  ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// =======================================================================</span></div><div class="line"><span class="comment">// function : TellMeSmthBad</span></div><div class="line"><span class="comment">// purpose  : Gives me bad news</span></div><div class="line"><span class="comment">// =======================================================================</span></div><div class="line"><span class="keywordtype">void</span> TellMeSmthBad()</div><div class="line">{</div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><h3>Block layout [MANDATORY]</h3>
<p>Figure brackets <em>{ }</em> and each operator <em>(for, if, else, try, catch)</em> should be written on a dedicated line.</p>
<p>In general, the layout should be as follows:</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (expression)</div><div class="line">{</div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><p>Entering a block increases and leaving a block decreases the indentation by one tabulation.</p>
<h3>Single-line operators</h3>
<p>Single-line conditional operators <em>(if, while, for,</em> etc.) can be written without brackets on the following line.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (!myIsInit) <span class="keywordflow">return</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a7b6e608c3535f709d07e1ad1c933ae20">Standard_False</a>; <span class="comment">// bad</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (thePtr == NULL)                   <span class="comment">// OK</span></div><div class="line">  <span class="keywordflow">return</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a7b6e608c3535f709d07e1ad1c933ae20">Standard_False</a>;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (!theAlgo.IsNull())                <span class="comment">// preferred</span></div><div class="line">{</div><div class="line">  DoSomething();</div><div class="line">}</div></div><!-- fragment --><p>Having all code in the same line is less convenient for debugging.</p>
<h3>Comparison expressions with constants</h3>
<p>In comparisons, put the variable (in the current context) on the left side and constant on the right side of expression. That is, the so called "Yoda style" is to be avoided.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (NULL != thePointer)    <span class="comment">// Yoda style, not recommended</span></div><div class="line"><span class="keywordflow">if</span> (thePointer != NULL)    <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (34 &lt; anIter)           <span class="comment">// Yoda style, not recommended</span></div><div class="line"><span class="keywordflow">if</span> (anIter &gt; 34)           <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (theNbValues &gt;= anIter) <span class="comment">// bad style (constant function argument vs. local variable)</span></div><div class="line"><span class="keywordflow">if</span> (anIter &lt;= theNbValues) <span class="comment">// OK</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (THE_LIMIT == theValue) <span class="comment">// bad style (global constant vs. variable)</span></div><div class="line"><span class="keywordflow">if</span> (theValue == THE_LIMIT) <span class="comment">// OK</span></div></div><!-- fragment --><h3>Alignment</h3>
<p>Use alignment wherever it enhances the readability. See the following example:</p>
<div class="fragment"><div class="line">MyPackage_MyClass anObject;</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a>     aMinimum = 0.0;</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>  aVal     = theVal;</div><div class="line"><span class="keywordflow">switch</span> (aVal)</div><div class="line">{</div><div class="line">  <span class="keywordflow">case</span> 0:  computeSomething();              <span class="keywordflow">break</span>;</div><div class="line">  <span class="keywordflow">case</span> 12: computeSomethingElse (aMinimum); <span class="keywordflow">break</span>;</div><div class="line">  <span class="keywordflow">case</span> 3:</div><div class="line">  <span class="keywordflow">default</span>: computeSomethingElseYet();       <span class="keywordflow">break</span>;</div><div class="line">}</div></div><!-- fragment --><h3>Indentation of comments</h3>
<p>Comments should be indented in the same way as the code to which they refer or they can be in the same line if they are short.</p>
<p>The text of the comment should be separated from the slash character by a single space character.</p>
<p>See the following example:</p>
<div class="fragment"><div class="line"><span class="keywordflow">while</span> (expression)   <span class="comment">//bad comment</span></div><div class="line">{</div><div class="line">  <span class="comment">// this is a long multi-line comment</span></div><div class="line">  <span class="comment">// which is really required</span></div><div class="line">  DoSomething();     <span class="comment">// maybe, enough</span></div><div class="line">  DoSomethingMore(); <span class="comment">// again</span></div><div class="line">}</div></div><!-- fragment --><h3>Early return statement</h3>
<p>Use an early return condition rather than collect indentations.</p>
<p>Write like this:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> ComputeSumm (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>* theArray,</div><div class="line">                              <span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_n_collection___sparse_array_base_8hxx.html#aafd0aa27030c44cea49764e622cedd68">Standard_Size</a>     theSize)</div><div class="line">{</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aSumm = 0;</div><div class="line">  <span class="keywordflow">if</span> (theArray == NULL || theSize == 0)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">  }</div><div class="line"></div><div class="line">  ... computing summ ...</div><div class="line">  <span class="keywordflow">return</span> aSumm;</div><div class="line">}</div></div><!-- fragment --><p>Rather than:</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> ComputeSumm (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a>* theArray,</div><div class="line">                              <span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_n_collection___sparse_array_base_8hxx.html#aafd0aa27030c44cea49764e622cedd68">Standard_Size</a>     theSize)</div><div class="line">{</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aSumm = 0;</div><div class="line">  <span class="keywordflow">if</span> (theArray != NULL &amp;&amp; theSize != 0)</div><div class="line">  {</div><div class="line">    ... computing summ ...</div><div class="line">  }</div><div class="line">  <span class="keywordflow">return</span> aSumm;</div><div class="line">}</div></div><!-- fragment --><p>This helps to improve readability and reduce the unnecessary indentation depth.</p>
<h3>Trailing spaces</h3>
<p>Trailing spaces should be removed whenever possible. Spaces at the end of a line are useless and do not affect functionality.</p>
<h3>Headers order</h3>
<p>Split headers into groups: system headers, headers per each framework, project headers; sort the list of includes alphabetically. Within the class source file, the class header file should be included first.</p>
<p>This rule improves readability, allows detecting useless multiple header inclusions and makes 3rd-party dependencies clearly visible. Inclusion of class header on top verifies consistency of the header (e.g. that header file does not use any undefined declarations due to missing includes of dependencies).</p>
<p>An exception to the rule is ordering system headers generating a macros declaration conflicts (like "windows.h" or "X11/Xlib.h") - these headers should be placed in the way solving the conflict.</p>
<div class="fragment"><div class="line"><span class="comment">// the header file of implemented class</span></div><div class="line"><span class="preprocessor">#include &lt;PackageName_ClassName.hxx&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// OCCT headers</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/gp___pnt_8hxx.html">gp_Pnt.hxx</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/gp___vec_8hxx.html">gp_Vec.hxx</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_n_collection___list_8hxx.html">NCollection_List.hxx</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Qt headers</span></div><div class="line"><span class="preprocessor">#include &lt;QDataStream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QString&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// system headers</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;windows.h&gt;</span></div></div><!-- fragment --><h1><a class="anchor" id="occt_coding_rules_4"></a>
Documentation rules</h1>
<p>The source code is one of the most important references for documentation. The comments in the source code should be complete enough to allow understanding the corresponding code and to serve as basis for other documents.</p>
<p>The main reasons why the comments are regarded as documentation and should be maintained are:</p><ul>
<li>The comments are easy to reach &ndash; they are always together with the source code;</li>
<li>It is easy to update a description in the comment when the source is modified;</li>
<li>The source by itself is a good context to describe various details that would require much more explanations in a separate document;</li>
<li>As a summary, this is the most cost-effective documentation.</li>
</ul>
<p>The comments should be compatible with Doxygen tool for automatic documentation generation (thus should use compatible tags).</p>
<h3>Documenting classes [MANDATORY]</h3>
<p>Each class should be documented in its header file (.hxx). The comment should give enough details for the reader to understand the purpose of the class and the main way of work with it.</p>
<h3>Documenting class methods [MANDATORY]</h3>
<p>Each class or package method should be documented in the header file (.hxx).</p>
<p>The comment should explain the purpose of the method, its parameters, and returned value(s). Accepted style is:</p>
<pre class="fragment">//! Method computes the square value.
//! @param theValue the input value
//! @return squared value
Standard_Export Standard_Real Square (Standard_Real theValue);
</pre><h3>Documenting C/C++ sources</h3>
<p>It is very desirable to put comments in the C/C++ sources of the package/class.</p>
<p>They should be detailed enough to allow any person to understand what each part of code does.</p>
<p>It is recommended to comment all static functions (like methods in headers), and to insert at least one comment per each 10-100 lines in the function body.</p>
<p>There are also some rules that define how comments should be formatted, see <a class="el" href="occt_dev_guides__coding_rules.html#occt_coding_rules_3">Formatting Rules</a>.</p>
<p>Following these rules is important for good comprehension of the comments. Moreover, this approach allows automatically generating user-oriented documentation directly from the commented sources.</p>
<h1><a class="anchor" id="occt_coding_rules_5"></a>
Application design</h1>
<p>The following rules define the common style, which should be applied by any developer contributing to the open source.</p>
<h3>Allow possible inheritance</h3>
<p>Try to design general classes (objects) keeping possible inheritance in mind. This rule means that the user who makes possible extensions of your class should not encounter problems of private implementation. Try to use protected members and virtual methods wherever you expect extensions in the future.</p>
<h3>Avoid friend declarations</h3>
<p>Avoid using 'friend' classes or functions except for some specific cases (for example, iteration) 'Friend' declarations increase coupling.</p>
<h3>Set/get methods</h3>
<p>Avoid providing set/get methods for all fields of the class. Intensive set/get functions break down encapsulation.</p>
<h3>Hiding virtual functions [MANDATORY]</h3>
<p>Avoid hiding a base class virtual function by a redefined function with a different signature. Most of the compilers issue warning on this.</p>
<h3>Avoid mixing error reporting strategies</h3>
<p>Try not to mix different error indication/handling strategies (exceptions or returned values) on the same application level.</p>
<h3>Minimize compiler warnings [MANDATORY]</h3>
<p>When compiling the source pay attention to and try to minimize compiler warnings.</p>
<h3>Avoid unnecessary inclusions</h3>
<p>Try to minimize compilation dependencies by removing unnecessary inclusions.</p>
<h1><a class="anchor" id="occt_coding_rules_6"></a>
General C/C++ rules</h1>
<p>This section defines the rules for writing a portable and maintainable C/C++ source code.</p>
<h3>Wrapping of global variables [MANDATORY]</h3>
<p>Use package or class methods returning reference to wrap global variables to reduce possible name space conflicts.</p>
<h3>Avoid private members</h3>
<p>Use <em>protected</em> members instead of <em>private</em> wherever reasonable to enable future extensions. Use <em>private</em> fields if future extensions should be disabled.</p>
<h3>Constants and inlines over defines [MANDATORY]</h3>
<p>Use constant variables (const) and inline functions instead of defines (#define).</p>
<h3>Avoid explicit numerical values [MANDATORY]</h3>
<p>Avoid usage of explicit numeric values. Use named constants and enumerations instead. Numbers produce difficulties for reading and maintenance.</p>
<h3>Three mandatory methods</h3>
<p>If a class has a destructor, an assignment operator or a copy constructor, it usually needs the other two methods.</p>
<h3>Virtual destructor</h3>
<p>A class with virtual function(s) ought to have a virtual destructor.</p>
<h3>Overriding virtual methods</h3>
<p>Declaration of overriding method should contains specifiers "virtual" and "override" (using Standard_OVERRIDE alias for compatibility with old compilers).</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyPackage_BaseClass</div><div class="line">{</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">  Standard_EXPORT <span class="keyword">virtual</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a03b92feca37cfb9c80cb41a5f6df6cef">Standard_Boolean</a> Perform();</div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class </span>MyPackage_MyClass : <span class="keyword">public</span> MyPackage_BaseClass</div><div class="line">{</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">  Standard_EXPORT <span class="keyword">virtual</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a03b92feca37cfb9c80cb41a5f6df6cef">Standard_Boolean</a> Perform() Standard_OVERRIDE;</div><div class="line"></div><div class="line">};</div></div><!-- fragment --><p>This makes class definition more clear (virtual methods become highlighted).</p>
<p>Declaration of interface using pure virtual functions protects against incomplete inheritance at first level, but does not help when method is overridden multiple times within nested inheritance or when method in base class is intended to be optional.</p>
<p>And here "override" specifier introduces additional protection against situations when interface changes might be missed (class might contain old methods which will be never called).</p>
<h3>Default parameter value</h3>
<p>Do not redefine a default parameter value in an inherited function.</p>
<h3>Use const modifier</h3>
<p>Use <em>const</em> modifier wherever possible (functions parameters, return values, etc.)</p>
<h3>Usage of goto [MANDATORY]</h3>
<p>Avoid <em>goto</em> statement unless it is really needed.</p>
<h3>Declaring variable in for() header</h3>
<p>Declare a cycle variable in the header of the <em>for()</em> statement if not used out of cycle.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a> aMinDist = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a017cf56f9e5dcb39bed601365e4d1021">Precision::Infinite</a>();</div><div class="line"><span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_n_collection___sequence.html">NCollection_Sequence&lt;gp_Pnt&gt;::Iterator</a> aPntIter (theSequence);</div><div class="line">     aPntIter.More(); aPntIter.Next())</div><div class="line">{</div><div class="line">  aMinDist = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___integer_8hxx.html#a688208dcf6c1e375231034089b4e43f9">Min</a> (aMinDist, theOrigin.Distance (aPntIter.Value()));</div><div class="line">}</div></div><!-- fragment --><h3>Condition statements within zero</h3>
<p>Avoid usage of C-style comparison for non-boolean variables:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Function (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> theValue,</div><div class="line">               <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a>*   thePointer)</div><div class="line">{</div><div class="line">  <span class="keywordflow">if</span> (!theValue)          <span class="comment">// bad style - ambiguous logic</span></div><div class="line">  {</div><div class="line">    DoSome();</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (theValue == 0)      <span class="comment">// OK</span></div><div class="line">  {</div><div class="line">    DoSome();</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (thePointer != NULL) <span class="comment">// OK, predefined NULL makes pointer comparison cleaner to reader</span></div><div class="line">  {                       <span class="comment">// (nullptr should be used instead as soon as C++11 will be available)</span></div><div class="line">    DoSome2();</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="occt_coding_rules_7"></a>
Portability issues</h1>
<p>This chapter contains rules that are critical for cross-platform portability.</p>
<h3>Provide code portability [MANDATORY]</h3>
<p>The source code must be portable to all platforms listed in the official 'Technical Requirements'. The term 'portable' here means 'able to be built from source'.</p>
<p>The C++ source code should meet C++03 standard. Any usage of compiler-specific features or further language versions (for example, C++11, until all major compilers on all supported platforms implement all its features) should be optional (used only with appropriate preprocessor checks) and non-exclusive (an alternative implementation compatible with other compilers should be provided).</p>
<h3>Avoid usage of global variables [MANDATORY]</h3>
<p>Avoid usage of global variables. Usage of global variables may cause problems when accessed from another shared library.</p>
<p>Use global (package or class) functions that return reference to static variable local to this function instead of global variables.</p>
<p>Another possible problem is the order of initialization of global variables defined in various libraries that may differ depending on platform, compiler and environment.</p>
<h3>Avoid explicit basic types</h3>
<p>Avoid explicit usage of basic types (<em>int</em>, <em>float</em>, <em>double</em>, etc.), use Open CASCADE Technology types from package <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a>: Standard_Integer, Standard_Real, Standard_ShortReal, Standard_Boolean, Standard_CString</em> and others or a specific <em>typedef</em> instead.</p>
<h3>Use <em>sizeof()</em> to calculate sizes [MANDATORY]</h3>
<p>Do not assume sizes of types. Use <em>sizeof()</em> instead to calculate sizes.</p>
<h3>Empty line at the end of file [MANDATORY]</h3>
<p>In accordance with C++03 standard source files should be trailed by an empty line. It is recommended to follow this rule for any plain text files for consistency and for correct work of git difference tools.</p>
<h1><a class="anchor" id="occt_coding_rules_8"></a>
Stability issues</h1>
<p>The rules listed in this chapter are important for stability of the programs that use Open CASCADE Technology libraries.</p>
<h3>Use <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_o_s_d.html#a652daf2b38e99787c25bce6a7ea8f713">OSD::SetSignal()</a></em> to catch exceptions</h3>
<p>When using Open CASCADE Technology in an application, call <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_o_s_d.html#a652daf2b38e99787c25bce6a7ea8f713">OSD::SetSignal()</a></em> function when the application is initialized.</p>
<p>This will install C handlers for run-time interrupt signals and exceptions, so that low-level exceptions (such as access violation, division by zero, etc.) will be redirected to C++ exceptions that use <em>try {...} catch (<a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard___failure.html">Standard_Failure</a>) {...}</em> blocks.</p>
<p>The above rule is especially important for robustness of modeling algorithms.</p>
<h3>Cross-referenced handles</h3>
<p>Take care about cycling of handled references to avoid chains, which will never be freed. For this purpose, use a pointer at one (subordinate) side.</p>
<p>See the following example:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Slave;</div><div class="line"></div><div class="line"><span class="keyword">class </span>Master : <span class="keyword">public</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard___transient.html">Standard_Transient</a></div><div class="line">{</div><div class="line">...</div><div class="line">  <span class="keywordtype">void</span> SetSlave (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___handle_8hxx.html#a464f2f86d5d805f03f4e3c9beb007e40">Handle</a>(Slave)&amp; theSlave)</div><div class="line">  { </div><div class="line">    mySlave = theSlave;</div><div class="line">  }</div><div class="line">...</div><div class="line">private:</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___handle_8hxx.html#a464f2f86d5d805f03f4e3c9beb007e40">Handle</a>(Slave) theSlave; <span class="comment">// smart pointer</span></div><div class="line">...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">class </span>Slave : <span class="keyword">public</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard___transient.html">Standard_Transient</a></div><div class="line">{</div><div class="line">...</div><div class="line">  <span class="keywordtype">void</span> SetMaster (<span class="keyword">const</span> <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___handle_8hxx.html#a464f2f86d5d805f03f4e3c9beb007e40">Handle</a>(Master)&amp; theMaster)</div><div class="line">  { </div><div class="line">    myMaster = theMaster.get();</div><div class="line">  }</div><div class="line">...</div><div class="line">private:</div><div class="line">  Master* theMaster; <span class="comment">// simple pointer</span></div><div class="line">...</div><div class="line">}</div></div><!-- fragment --><h3>C++ memory allocation</h3>
<p>In C++ use <em>new</em> and <em>delete</em> operators instead of <em>malloc()</em> and <em>free()</em>. Try not to mix different memory allocation techniques.</p>
<h3>Match <em>new</em> and <em>delete</em> [MANDATORY]</h3>
<p>Use the same form of new and delete.</p>
<div class="fragment"><div class="line">aPtr1 = <span class="keyword">new</span> TypeA[n];              ... ; <span class="keyword">delete</span>[]        aPtr1;</div><div class="line">aPtr2 = <span class="keyword">new</span> TypeB();               ... ; <span class="keyword">delete</span>          aPtr2;</div><div class="line">aPtr3 = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html#aaaaa204e9cefcae7bafb6da8b941b46a">Standard::Allocate</a> (4096); ... ; <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html#a6ef68946681e34cafcf847e1695bd600">Standard::Free</a> (aPtr3);</div></div><!-- fragment --><h3>Methods managing dynamical allocation [MANDATORY]</h3>
<p>Define a destructor, a copy constructor and an assignment operator for classes with dynamically allocated memory.</p>
<h3>Uninitialized variables [MANDATORY]</h3>
<p>Every variable should be initialized.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aTmpVar1;     <span class="comment">// bad</span></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> aTmpVar2 = 0; <span class="comment">// OK</span></div></div><!-- fragment --><p>Uninitialized variables might be kept only within performance-sensitive code blocks and only when their initialization is guaranteed by subsequent code.</p>
<h3>Do not hide global <em>new</em></h3>
<p>Avoid hiding the global <em>new</em> operator.</p>
<h3>Assignment operator</h3>
<p>In <em>operator=()</em> assign to all data members and check for assignment to self.</p>
<h3>Float comparison</h3>
<p>Don't check floats for equality or non-equality; check for GT, GE, LT or LE.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (Abs (theFloat1 - theFloat2) &lt; theTolerance)</div><div class="line">{</div><div class="line">  DoSome();</div><div class="line">}</div></div><!-- fragment --><p>Package <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html">Precision</a></em> provides standard values for SI units and widely adopted by existing modeling algorithms:</p>
<ul>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a94f8d5777a3e8e1c61bd7bbfa8dfc0eb">Precision::Confusion()</a></em> for lengths in meters;</li>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a873857668aabfc6c21da9bdc78464a3f">Precision::Angular()</a></em> for angles in radians.</li>
</ul>
<p>as well as definition of infinite values within normal range of double precision:</p><ul>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a017cf56f9e5dcb39bed601365e4d1021">Precision::Infinite()</a></em></li>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#ac7309806c042ca49a60e84250294893d">Precision::IsInfinite()</a></em></li>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a977b747b3b5afc26ff6398f7595c138e">Precision::IsPositiveInfinite()</a></em></li>
<li><em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html#a56420db53fee947a8004a606e719e3b7">Precision::IsNegativeInfinite()</a></em></li>
</ul>
<h3>Non-indexed iteration</h3>
<p>Avoid usage of iteration over non-indexed collections of objects. If such iteration is used, make sure that the result of the algorithm does not depend on the order of iterated items.</p>
<p>Since the order of iteration is unpredictable in case of a non-indexed collection of objects, it frequently leads to different behavior of the application from one run to another, thus embarrassing the debugging process.</p>
<p>It mostly concerns mapped objects for which pointers are involved in calculating the hash function. For example, the hash function of <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html">TopoDS_Shape</a></em> involves the address of <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___t_shape.html">TopoDS_TShape</a></em> object. Thus the order of the same shape in the <em>TopTools_MapOfShape</em> will vary in different sessions of the application.</p>
<h3>Do not throw in destructors</h3>
<p>Do not throw from within a destructor.</p>
<h3>Assigning to reference [MANDATORY]</h3>
<p>Avoid the assignment of a temporary object to a reference. This results in a different behavior for different compilers on different platforms.</p>
<h1><a class="anchor" id="occt_coding_rules_9"></a>
Performance issues</h1>
<p>These rules define the ways of avoiding possible loss of performance caused by ineffective programming.</p>
<h3>Class fields alignment</h3>
<p>Declare fields of a class in the decreasing order of their size for better alignment. Generally, try to reduce misaligned accesses since they impact the performance (for example, on Intel machines).</p>
<h3>Fields initialization order [MANDATORY]</h3>
<p>List class data members in the constructor's initialization list in the order they are declared.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>MyPackage_MyClass</div><div class="line">{</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">  MyPackage_MyClass()</div><div class="line">  : myPropertyA (1),</div><div class="line">    myPropertyB (2) {}</div><div class="line"></div><div class="line"><span class="comment">// NOT</span></div><div class="line"><span class="comment">// : myPropertyB (2),</span></div><div class="line"><span class="comment">//   myPropertyA (1) {}</span></div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line"></div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> myPropertyA;</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> myPropertyB;</div><div class="line"></div><div class="line">};</div></div><!-- fragment --><h3>Initialization over assignment</h3>
<p>Prefer initialization over assignment in class constructors.</p>
<div class="fragment"><div class="line">MyPackage_MyClass()</div><div class="line">: myPropertyA (1)  <span class="comment">// preferred</span></div><div class="line">{</div><div class="line">  myPropertyB = 2; <span class="comment">// not recommended</span></div><div class="line">}</div></div><!-- fragment --><h3>Optimize caching</h3>
<p>When programming procedures with extensive memory access, try to optimize them in terms of cache behavior. Here is an example of how the cache behavior can be impacted:</p>
<p>On x86 this code</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a> anArray[4096][2];</div><div class="line"><span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anIter = 0; anIter &lt; 4096; ++anIter)</div><div class="line">{</div><div class="line">  anArray[anIter][0] = anArray[anIter][1];</div><div class="line">}</div></div><!-- fragment --><p>is more efficient then</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a> anArray[2][4096];</div><div class="line"><span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anIter = 0; anIter &lt; 4096; ++anIter)</div><div class="line">{</div><div class="line">  anArray[0][anIter] = anArray[1][anIter];</div><div class="line">}</div></div><!-- fragment --><p>since linear access does not invalidate cache too often.</p>
<h1><a class="anchor" id="occt_coding_rules_10"></a>
Draw Harness command</h1>
<p><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Harness provides TCL interface for OCCT algorithms.</p>
<p>There is no TCL wrapper over OCCT C++ classes, instead interface is provided through the set of TCL commands implemented in C++.</p>
<p>There is a list of common rules which should be followed to implement well-formed <a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Harness command.</p>
<h3>Return value</h3>
<p>Command should return 0 in most cases even if the executed algorithm has failed. Returning 1 would lead to a TCL exception, thus should be used in case of a command line syntax error and similar issues.</p>
<h3>Validate input parameters</h3>
<p>Command arguments should be validated before usage. The user should see a human-readable error description instead of a runtime exception from the executed algorithm.</p>
<h3>Validate the number of input parameters</h3>
<p>Command should warn the user about unknown arguments, including cases when extra parameters have been pushed for the command with a fixed number of arguments.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (theArgsNb != 3)</div><div class="line">{</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Syntax error - wrong number of arguments!\n&quot;</span>;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div><div class="line"></div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anArgIter  = 1;</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aee98bfe6774a1f4d9570c388805de3cc">Standard_CString</a> aResName   = theArgVec[anArgIter++];</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aee98bfe6774a1f4d9570c388805de3cc">Standard_CString</a> aFaceName  = theArgVec[anArgIter++];</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html">TopoDS_Shape</a>     aFaceShape = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_d_b_rep.html#aeb6625574ca9dbe15a0aeddb5157cf97">DBRep::Get</a> (aFaceName);</div><div class="line"><span class="keywordflow">if</span> (aFaceShape.<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html#a6eda241931ad8210868f5438c8978f84">IsNull</a>()</div><div class="line"> || aFaceShape.<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html#adb1e564b8db9872a241d97883bea184e">ShapeType</a>() != <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_top_abs___shape_enum_8hxx.html#a67b8aa38656811eaee45f9df08499667a6085c6950ee7034040ef4b5c9be16f8c">TopAbs_FACE</a>)</div><div class="line">{</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Shape &quot;</span> &lt;&lt; aFaceName &lt;&lt; <span class="stringliteral">&quot; is empty or not a Face!\n&quot;</span>;</div><div class="line">  <span class="keywordflow">return</span> 1;</div><div class="line">}</div><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_d_b_rep.html#a35c2ed5c27f7e6a31f8e5a30ba639ead">DBRep::Set</a> (aResName, aFaceShape);</div><div class="line"><span class="keywordflow">return</span> 0;</div></div><!-- fragment --><h3><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_message.html">Message</a> printing</h3>
<p>Informative messages should be printed into standard output <em>std::cout</em>, whilst command results (if any) &ndash; into <a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Interpreter.</p>
<p>Information printed into <a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Interpreter should be well-structured to allow usage in TCL script.</p>
<h3>Long list of arguments</h3>
<p>Any command with a long list of obligatory parameters should be considered as ill-formed by design. Optional parameters should start with flag name (with '-' prefix) and followed by its values:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myCommand -flag1 value1 value2 -flag2 value3</div></div><!-- fragment --><h3>Arguments parser</h3>
<ul>
<li>Integer values should be read using <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a07727e5e46379b45b7606603987beca7">Draw::Atoi()</a></em> function.</li>
<li>Real values should be read using <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a374a4d67b77aa308ce98fed783eb50f5">Draw::Atof()</a></em> function.</li>
<li>Flags names should be checked in case insensitive manner.</li>
</ul>
<p>Functions <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a374a4d67b77aa308ce98fed783eb50f5">Draw::Atof()</a></em> and <em><a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a07727e5e46379b45b7606603987beca7">Draw::Atoi()</a></em> support expressions and read values in C-locale.</p>
<div class="fragment"><div class="line"><a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aef96be6ca3bae9762e592db2b356bc4c">Standard_Real</a> aPosition[3] = {0.0, 0.0, 0.0};</div><div class="line"><span class="keywordflow">for</span> (<a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#a844729aed1c6f9f5aadd6d4e9ddd5984">Standard_Integer</a> anArgIter = 1; anArgIter &lt; theArgsNb; ++anArgIter)</div><div class="line">{</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/_standard___type_def_8hxx.html#aee98bfe6774a1f4d9570c388805de3cc">Standard_CString</a> anArg = theArgVec[anArgIter];</div><div class="line">  <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_t_collection___ascii_string.html">TCollection_AsciiString</a> aFlag (anArg);</div><div class="line">  aFlag.LowerCase(); <span class="comment">//!&lt; for case insensitive comparison</span></div><div class="line"><span class="comment"></span>  <span class="keywordflow">if</span> (aFlag == <span class="stringliteral">&quot;position&quot;</span>)</div><div class="line">  {</div><div class="line">    <span class="keywordflow">if</span> ((anArgIt + 3) &gt;= theArgsNb)</div><div class="line">    {</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Wrong syntax at argument &#39;&quot;</span> &lt;&lt; anArg &lt;&lt; <span class="stringliteral">&quot;&#39;!\n&quot;</span>;</div><div class="line">      <span class="keywordflow">return</span> 1;</div><div class="line">    }</div><div class="line">    aPosition[0] = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a374a4d67b77aa308ce98fed783eb50f5">Draw::Atof</a> (theArgVec[++anArgIt]);</div><div class="line">    aPosition[1] = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a374a4d67b77aa308ce98fed783eb50f5">Draw::Atof</a> (theArgVec[++anArgIt]);</div><div class="line">    aPosition[2] = <a class="codeRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html#a374a4d67b77aa308ce98fed783eb50f5">Draw::Atof</a> (theArgVec[++anArgIt]);</div><div class="line">  }</div><div class="line">  <span class="keywordflow">else</span></div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Syntax error! Unknown flag &#39;&quot;</span> &lt;&lt; anArg &lt;&lt; <span class="stringliteral">&quot;&#39;\n&quot;</span>;</div><div class="line">    <span class="keywordflow">return</span> 1;</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="occt_coding_rules_11"></a>
Examples</h1>
<h3>Sample documented class</h3>
<pre class="fragment">class Package_Class
{

public: //! @name public methods

  //! Method computes the square value.
  //! @param theValue the input value
  //! @return squared value
  Standard_Export Standard_Real Square (const Standard_Real theValue);

private: //! \@name private methods

  //! Auxiliary method
  void increment();

private: //! \@name private fields

  Standard_Integer myCounter; //!&lt; usage counter

};</pre><div class="fragment"><div class="line">#include &lt;Package_Class.hxx&gt;</div><div class="line">// ==========================================================</div><div class="line">// function : Square</div><div class="line">// purpose  : Method computes the square value</div><div class="line">// ==========================================================</div><div class="line">Standard_Real Package_Class::Square (const Standard_Real theValue)</div><div class="line">{</div><div class="line">  increment();</div><div class="line">  return theValue * theValue;</div><div class="line">}</div><div class="line"></div><div class="line">// ==========================================================</div><div class="line">// function : increment</div><div class="line">// purpose  :</div><div class="line">// ==========================================================</div><div class="line">void Package_Class::increment()</div><div class="line">{</div><div class="line">  ++myCounter;</div><div class="line">}</div></div><!-- fragment --><h3>TCL script for <a class="elRef" doxygen="C:/builds/IR-2017-08-29_IR-2017-08-29/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_draw.html">Draw</a> Harness</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># show fragments (solids) in shading with different colors</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span><span class="keyword">proc</span> DisplayColored {theShape} {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  <span class="keyword">set</span> aSolids [uplevel #0 explode $theShape so]<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span>  <span class="keyword">set</span> aColorIter 0<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span>  <span class="keyword">set</span> THE_COLORS {red green blue1 magenta1 yellow cyan1 brown}<span class="comment"></span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span>  <span class="keyword">foreach</span> aSolIter $aSolids {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    uplevel #0 vdisplay         $aSolIter<span class="comment"></span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span>    uplevel #0 vsetcolor        $aSolIter [<span class="keyword">lindex</span> $THE_COLORS [<span class="keyword">expr</span> [<span class="keyword">incr</span> aColorIter] % [<span class="keyword">llength</span> $THE_COLORS]]]<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span>    uplevel #0 vsetdispmode     $aSolIter 1<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span>    uplevel #0 vsetmaterial     $aSolIter plastic<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span>    uplevel #0 vsettransparency $aSolIter 0.5<span class="comment"></span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span>  }<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span>}<span class="comment"></span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"># load modules</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span>pload MODELING VISUALIZATION<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"># create boxes</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span>box bc  0 0 0 1 1 1<span class="comment"></span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span>box br  1 0 0 1 1 2<span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span>compound bc br c<span class="comment"></span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"># show fragments (solids) in shading with different colors</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span>vinit View1<span class="comment"></span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span>vclear<span class="comment"></span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span>vaxo<span class="comment"></span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span>vzbufftrihedron<span class="comment"></span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span>DisplayColored c<span class="comment"></span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span>vfit<span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span>vdump $imagedir/${casename}.png 512 512</div></div><!-- fragment --><h3>GLSL program:</h3>
<div class="fragment"><div class="line">vec3 Ambient;  //!&lt; Ambient  contribution of light sources</div><div class="line">vec3 Diffuse;  //!&lt; Diffuse  contribution of light sources</div><div class="line">vec3 Specular; //!&lt; Specular contribution of light sources</div><div class="line"></div><div class="line">//! Computes illumination from light sources</div><div class="line">vec4 ComputeLighting (in vec3 theNormal,</div><div class="line">                      in vec3 theView,</div><div class="line">                      in vec4 thePoint)</div><div class="line">{</div><div class="line">  // clear the light intensity accumulators</div><div class="line">  Ambient  = occLightAmbient.rgb;</div><div class="line">  Diffuse  = vec3 (0.0);</div><div class="line">  Specular = vec3 (0.0);</div><div class="line">  vec3 aPoint = thePoint.xyz / thePoint.w;</div><div class="line">  for (int anIndex = 0; anIndex &lt; occLightSourcesCount; ++anIndex)</div><div class="line">  {</div><div class="line">    int aType = occLight_Type (anIndex);</div><div class="line">    if (aType == OccLightType_Direct)</div><div class="line">    {</div><div class="line">      directionalLight (anIndex, theNormal, theView);</div><div class="line">    }</div><div class="line">    else if (aType == OccLightType_Point)</div><div class="line">    {</div><div class="line">      pointLight (anIndex, theNormal, theView, aPoint);</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  return vec4 (Ambient,  1.0) * occFrontMaterial_Ambient()</div><div class="line">       + vec4 (Diffuse,  1.0) * occFrontMaterial_Diffuse()</div><div class="line">       + vec4 (Specular, 1.0) * occFrontMaterial_Specular();</div><div class="line">}</div><div class="line"></div><div class="line">//! Entry point to the Fragment Shader</div><div class="line">void main()</div><div class="line">{</div><div class="line">  gl_FragColor = computeLighting (normalize (Normal),</div><div class="line">                                  normalize (View),</div><div class="line">                                  Position);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Aug 30 2017 17:08:50 for Open CASCADE Technology by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
