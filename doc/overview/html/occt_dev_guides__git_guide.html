<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open CASCADE Technology: Guide to installing and using Git for OCCT development</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('occt_dev_guides__git_guide.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Guide to installing and using Git for OCCT development </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#occt_gitguide_1">Overview</a><ul><li class="level2"><a href="#occt_gitguide_1_1">Purpose</a></li>
<li class="level2"><a href="#occt_gitguide_1_2">Git URL</a></li>
<li class="level2"><a href="#occt_gitguide_1_3">Content</a></li>
<li class="level2"><a href="#occt_gitguide_1_4">Short rules of use</a></li>
<li class="level2"><a href="#occt_gitguide_1_5">Version of Git</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_gitguide_2">Installing Tools for Work with Git</a><ul><li class="level2"><a href="#occt_gitguide_2_1">Windows platform</a><ul><li class="level3"><a href="#occt_gitguide_2_1_1">Installation of Git for Windows</a></li>
<li class="level3"><a href="#occt_gitguide_2_1_2">Installation and configuration of TortoiseGit</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_gitguide_2_2">Linux platform</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_gitguide_3">Getting access to the repository</a><ul><li class="level2"><a href="#occt_gitguide_3_1">Prerequisites</a></li>
<li class="level2"><a href="#occt_gitguide_3_2">How to generate a key</a><ul><li class="level3"><a href="#occt_gitguide_3_2_1">Generating key with Putty</a></li>
<li class="level3"><a href="#occt_gitguide_3_2_2">Generating key with command-line tools</a></li>
<li class="level3"><a href="#occt_gitguide_3_2_3">Generating key with Git GUI</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_gitguide_3_3">Adding public key in your account</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_gitguide_4">Work with repository: developer operations</a><ul><li class="level2"><a href="#occt_gitguide_4_1">General workflow</a></li>
<li class="level2"><a href="#occt_gitguide_4_2">Cloning official repository</a></li>
<li class="level2"><a href="#occt_gitguide_4_3">Branch creation</a></li>
<li class="level2"><a href="#occt_gitguide_4_4">Branch switching</a></li>
<li class="level2"><a href="#occt_gitguide_4_5">Committing branch changes</a></li>
<li class="level2"><a href="#occt_gitguide_4_6">Pushing branch to the remote repository</a></li>
<li class="level2"><a href="#occt_gitguide_4_7">Synchronizing with remote repository</a></li>
<li class="level2"><a href="#occt_gitguide_4_8">Applying a fix made on older version of OCCT</a></li>
<li class="level2"><a href="#occt_gitguide_4_9">Rebasing with history clean-up</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_gitguide_5">Work with repository: Reviewer operations</a><ul><li class="level2"><a href="#occt_gitguide_5_1">Review branch changes using GitWeb</a></li>
<li class="level2"><a href="#occt_gitguide_5_2">Review branch changes with TortoiseGit</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="occt_gitguide_1"></a>
Overview</h1>
<h2><a class="anchor" id="occt_gitguide_1_1"></a>
Purpose</h2>
<p>The purpose of this document is to provide a practical introduction to Git to OCCT developers who are not familiar with this tool and to facilitate the use of the official OCCT Git repository for code contribution to OCCT.</p>
<p>Reading this document does not exempt from the need to learn Git concepts and tools. Please consult a book or manual describing Git to get acquainted with this tool. Many good books on Git can be found at <a href="http://git-scm.com/documentation">http://git-scm.com/documentation</a></p>
<p>For the experienced Git users it can be enough to read sections 1 and 3 of this document to start working with the repository.</p>
<p>Please make sure to get familiar with the Contribution Workflow document that describes how Git is used for processing contributions to OCCT.</p>
<p>This and related documents are available at the Resources page of the OCCT development portal at <a href="http://dev.opencascade.org/index.php?q=home/resources">http://dev.opencascade.org/index.php?q=home/resources</a>.</p>
<h2><a class="anchor" id="occt_gitguide_1_2"></a>
Git URL</h2>
<p>URL of the official OCCT source code Git repository (accessed by SSH protocol) is: </p><pre class="fragment">gitolite@git.dev.opencascade.org:occt
</pre><p>or </p><pre class="fragment">ssh://gitolite@dev.opencascade.org/occt.git
</pre><h2><a class="anchor" id="occt_gitguide_1_3"></a>
Content</h2>
<p>The official repository contains:</p>
<ul>
<li>The current certified version of OCCT: the "master" branch. This branch is updated by the Bugmaster only. Official OCCT releases are marked by tags.</li>
<li>Topic branches created by contributors to submit changes for review / testing or for collaborative development. The topic branches should be named by the pattern "CR12345" where 12345 is the ID of the relevant issue registered in Mantis (without leading zeroes), and "CR" stands for "Change Request". The name can have an additional postfix used if more than one branch was created for the same issue.</li>
<li>Occasionally topic branches with non-standard names can be created by the Bugmaster for special needs.</li>
</ul>
<h2><a class="anchor" id="occt_gitguide_1_4"></a>
Short rules of use</h2>
<p>The name specified in the user.name field in Git configuration should correspond to your login name on the OCCT development portal. This is important to clearly identify the authorship of commits. (The full real name can be used as well; in this case add the login username in parentheses.)</p>
<p>By default, contributors are allowed to push branches only with the names starting with CR (followed by the relevant Mantis issue ID). Possibility to work with other branches can be enabled by the Bugmaster on request.</p>
<p>The branch is created by the developer in his local repository when the development of a contribution starts. The branch for new developments is to be created from the current master. The branch for integration of patches or developments based on an obsolete version is created from a relevant tag or commit. The branch should be pushed to the official repo only when sharing with other people (for collaborative work or review / testing) is needed.</p>
<p>Rebasing the local branch to the current master is encouraged before the first submission to the official repository. If rebasing was needed after the branch is pushed to the official repo, the rebased branch should have a different name (use suffix).</p>
<p>Integration of contributions that have passed certification testing is made exclusively by the Bugmaster. Normally this is made by rebasing the contribution branch on the current master and squashing it into a single commit. This is made to have the master branch history plain and clean, following the general rule “one issue &ndash; one commit”. The description of the commit integrated to the master branch is taken from the Mantis issue (ID, 'Summary', followed by the information from 'Documentation' field if present).</p>
<p>In special cases when it is important to save the commits history in the branch (e.g. in case of a long-term development integration) it can be integrated by merge (no fast-forward).</p>
<p>The authorship of the contribution is respected by preserving the Author field of the commit when integrating. Branches are removed from the official repository when integrated to the master. The Bugmaster can also remove branches which have no commits during one-month period.</p>
<p>The Bugmaster may ask the developer (normally the one who produced the contribution) to rebase a branch on the current master, in the case if merge conflicts appear during integration.</p>
<h2><a class="anchor" id="occt_gitguide_1_5"></a>
Version of Git</h2>
<p>The repository is tested to work with Git 1.7.6 and above. Please do not use versions below 1.7.1 as they are known to cause troubles.</p>
<h1><a class="anchor" id="occt_gitguide_2"></a>
Installing Tools for Work with Git</h1>
<h2><a class="anchor" id="occt_gitguide_2_1"></a>
Windows platform</h2>
<p>Installation of Git for Windows (provided by MSysGit project) is required.</p>
<p>In addition, it is recommended to install TortoiseGit to work with Git on Windows. If you do not install TortoiseGit or any other GUI tool, you can use GitGui and Gitk GUI tools delivered with Git and available on all platforms.</p>
<h3><a class="anchor" id="occt_gitguide_2_1_1"></a>
Installation of Git for Windows</h3>
<p>Download Git for Windows distributive from <a href="https://git-for-windows.github.io/">https://git-for-windows.github.io/</a> During the installation:</p>
<ul>
<li>Check-in "Windows Explorer integration" options:<ul>
<li>"Git Bash Here";</li>
<li>"Git GUI Here".</li>
</ul>
</li>
<li>To avoid a mess in your PATH, we recommend selecting "Run Git from Windows Prompt" in the environment settings dialog:</li>
<li>In "Configuring the line ending conversions" dialog, select "Checkout Windows-style, commit Unix style endings".</li>
</ul>
<p>Note that by default Git user interface is localized to the system default language. If you prefer to work with the English interface, remove or rename .msg localization file in subdirectories <em>share/git-gui/lib/msgs</em> and <em>share/gitk/lib/msgs</em> of the Git installation directory.</p>
<p>Before the first commit to the OCCT repository, make sure that your User Name in the Git configuration file (file <em>.gitconfig</em> in the <em>$HOME</em> directory) is equal to your username on the OCCT development portal.</p>
<h3><a class="anchor" id="occt_gitguide_2_1_2"></a>
Installation and configuration of TortoiseGit</h3>
<p>Download TortoiseGit distributive from <a href="http://code.google.com/p/tortoisegit/downloads/list">http://code.google.com/p/tortoisegit/downloads/list</a>. Launch the installation.</p>
<ul>
<li>Select your SSH client. Choose option<ul>
<li>"OpenSSH, Git default SSH Client" if you prefer to use command-line tools for SSH keys generation, or</li>
<li>"TortoisePLink, coming from Putty, integrates with Windows better" if you prefer to use GUI tool (PuttyGen, see 3.2).</li>
</ul>
</li>
<li><p class="startli">Complete the installation.</p>
<p class="startli">TortoiseGit integrates into Windows Explorer, thus it is possible to use context menu in Windows Explorer to access its functionality:</p>
</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image005.png" alt="OCCT_GitGuide_V2_image005.png"/>
</div>
<p>Note that if you have installed MSysGit or have Git installed in non-default path, on the first time you use TortoiseGit you may get the message demanding to define path to Git. In such case, click on <b>Set MSysGit path</b> button and add the path to git.exe and path to MigGW libraries in the Settings dialog.</p>
<ul>
<li>After the installation select Start -&gt; Programs -&gt; TortoiseGit Settings to configure TortoiseGit.</li>
</ul>
<p>Select Git-&gt;Config to add your user name and Email address to the local <em>.gitconfig</em> file</p>
<div class="image">
<img src="OCCT_GitGuide_V2_image006.png" alt="OCCT_GitGuide_V2_image006.png"/>
</div>
<p>Optionally, you can set up TortoiseGit to use visual diff utility for SVG images used in OCCT documentation. For that, click on item "Diff Viewer" in the Settings dialog, then click button "Advanced..." on the right tab add new record with the following parameters:</p><ul>
<li>Extension: <code>.svg</code></li>
<li>External program: <code>&lt;path_to_OCCT&gt;\adm\svgdiff.bat %base %mine %bname %yname</code></li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_svgdiff.png" alt="OCCT_GitGuide_V2_svgdiff.png"/>
</div>
<h2><a class="anchor" id="occt_gitguide_2_2"></a>
Linux platform</h2>
<p>We assume that Linux users have Git already installed and available in the <em>PATH</em>.</p>
<p>Make sure to configure Git so that the user name is equal to your username on the OCCT development portal, and set SafeCrLf option to true:</p>
<div class="fragment"><div class="line">&gt; git config --global user.name &quot;Your User Name&quot;</div><div class="line">&gt; git config --global user.email your@mail.address</div><div class="line">&gt; git config --global your@mail.address</div></div><!-- fragment --><h1><a class="anchor" id="occt_gitguide_3"></a>
Getting access to the repository</h1>
<h2><a class="anchor" id="occt_gitguide_3_1"></a>
Prerequisites</h2>
<p>Access to the repository is granted to the users who have signed the Contributor License Agreement.</p>
<p>The repository is accessed by SSH protocol, thus you need to register your public SSH key on the development portal to get access to the repository.</p>
<p>SSH keys are used for secure authentication of the user when accessing the Git server. Private key is the one stored on the user workstation (optionally encrypted). Open (or public) key is stored in the user account page on the web site. When Git client accesses the remote repository through SSH, it uses this key pair to identify the user and acquire relevant access rights.</p>
<p>Normally when you have Git installed, you should have also SSH client available. On Unix/Linux it is installed by default in the system. On Windows it is typical to have several SSH clients installed; in particular they are included with Cygwin, Git, TortoiseGit.</p>
<p>It is highly recommended to use the tools that come with the chosen Git client for generation of SSH keys. Using incompatible tools (e.g. <em>ssh-keygen.exe</em> from Cygwin for code generation, and TortoiseGit GUI with a default Putty client for connection to server) may lead to authentication problems.</p>
<h2><a class="anchor" id="occt_gitguide_3_2"></a>
How to generate a key</h2>
<h3><a class="anchor" id="occt_gitguide_3_2_1"></a>
Generating key with Putty</h3>
<p>Use this option if you have installed TortoiseGit (or other GUI Git client on Windows) and have chosen “TortoisePLink” (or other Putty client) as SSH client during installation.</p>
<p>To generate the key with this client, run <b>Puttygen</b> (e.g. from Start menu -&gt; TortoiseGit -&gt; Puttygen), then click <b>Generate</b> and move mouse cursor over the blank area until the key is generated.</p>
<div class="image">
<img src="OCCT_GitGuide_V2_image007.png" alt="OCCT_GitGuide_V2_image007.png"/>
<div class="caption">
Putty key generator</div></div>
<p>After the key is generated, you will see GUI controls to define the public key comment and / or specify the password for the private key protection. When done, save both the public and the private key to the files of your choice (make sure to store your private key in a secure place!).</p>
<p>Copy the public key as shown by Puttygen to the clipboard to add it in your account. Do not copy the Putty public key file content &ndash; it is formatted in a way not suitable for the web site.</p>
<h3><a class="anchor" id="occt_gitguide_3_2_2"></a>
Generating key with command-line tools</h3>
<p>Use this option if you work on Linux or if you have chosen “OpenSSH” as SSH client during installation of TortoiseGit (or other Windows tool).</p>
<p>Make sure that you have <em>ssh</em> and <em>ssh-keygen</em> commands in the path. On Windows, you might need to start <b>Git Bash</b> command prompt window.</p>
<p>Use the following command to generate SSH keys: </p><div class="fragment"><div class="line">&gt; ssh-keygen -t rsa -C &quot;your@mail.address&quot;</div></div><!-- fragment --><p>The last argument is an optional comment, which can be included with the public key and used to distinguish between different keys (if you have many). The common practice is to put here your mail address or workstation name.</p>
<p>The command will ask you where to store the keys. It is recommended to accept the default path <em>$HOME/.ssh/id_rsa</em>. Just press <b>Enter</b> for that. You will be warned if a key is already present in the specified file; you can either overwrite it by the new one, or stop generation and use the old key.</p>
<p>If you want to be on the safe side, enter password to encrypt the private key. You will be asked to enter this password each time you use that key (e.g. access a remote Git repository), unless you use the tool that caches the key (like TortoiseGit). If you do not want to bother, enter an empty string.</p>
<p>On Windows, make sure to note the complete path to the generated files (the location of your $HOME might be not obvious). Two key files will be created in the specified location (by default in $HOME/.ssh/):</p>
<ul>
<li><em>id_rsa</em> &ndash; private key</li>
<li><em>id_rsa.pub</em> &ndash; public key</li>
</ul>
<p>The content of the public key file (one text line) is the key to be added to the user account on the site (see below).</p>
<h3><a class="anchor" id="occt_gitguide_3_2_3"></a>
Generating key with Git GUI</h3>
<p>GitGUI (standard GUI interface included with Git) provides the option to either generate the SSH key (if not present yet) or show the existing one. Click Help/Show SSH key and copy the public key content for adding to the user account page (see below).</p>
<h2><a class="anchor" id="occt_gitguide_3_3"></a>
Adding public key in your account</h2>
<p>Log in on the portal <a href="http://dev.opencascade.org">http://dev.opencascade.org</a> and click on <b>My account</b> link to the right. If you have a Contributor status, you will see <b>SSH keys</b> tab to the right.</p>
<p>Click on that tab, then click <b>Add a public key</b>, and paste the text of the public key (see above sections on how to generate the key) into the text box.</p>
<p>Click <b>Save</b> to input the key to the system.</p>
<p>Note that a user can have several SSH keys. You can distinguish between these keys by the Title field ID; by default it is taken from SSH key comment. It is typical to use your e-mail address or workstation name for this field; no restrictions are set by the portal.</p>
<p>Please note that some time (5-10 min) is needed for the system to update the configuration after the new key is added. After that time, you can try accessing Git.</p>
<h1><a class="anchor" id="occt_gitguide_4"></a>
Work with repository: developer operations</h1>
<h2><a class="anchor" id="occt_gitguide_4_1"></a>
General workflow</h2>
<p>To start working with OCCT source repository, you need to create its clone in your local system. This cloned repository will manage your working copy of the sources and provide you the means to exchange code between your clone and the origin.</p>
<p>In most cases it is sufficient to have one clone of the repository; your working copy will be updated automatically by Git when you switch branches.</p>
<p>The typical development cycle for an issue is as follows:</p>
<ul>
<li>Create a new branch for your development, basing on the selected version of the sources (usually the current master) and switch your working copy to it</li>
<li>Develop and test your change.</li>
<li>Do as many commits in your branch as you feel convenient; the general recommendation is to commit every stable state (even incomplete), to record the history of your development.</li>
<li>Push your branch to the repository when your development is complete or when you need to share it with other people (e.g. for review)</li>
<li>Before the first push, rebase your local branch on the latest master; consider collapsing the history in one commit unless you think the history of your commits is interesting for others. Make sure to provide a good commit message.</li>
<li>Do not amend the commits that have been already pushed in the remote repository, If you need to rebase your branch, commit the rebased branch under a different name, and remove the old branch.</li>
</ul>
<p>You can switch to another branch at any moment (unless you have some uncommitted changes in the working copy) and return back to the branch when necessary (e.g. to take into account review remarks). Note that only the sources that are different between the switched branches will be modified, thus required recompilation should be reasonably small in most cases.</p>
<h2><a class="anchor" id="occt_gitguide_4_2"></a>
Cloning official repository</h2>
<p>Clone the official OCCT repository in one of following ways:</p>
<ul>
<li>From command line by command:</li>
</ul>
<div class="fragment"><div class="line">&gt; git clone gitolite@git.dev.opencascade.org:occt &lt;path&gt;</div></div><!-- fragment --><p>where <em>&lt;path&gt;</em> is the path to the new folder which will be created for the repository.</p>
<ul>
<li>In TortoiseGit: create a new folder, open it and right-click in the Explorer window, then choose <b>Git Clone</b> in the context menu:</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image009.png" alt="OCCT_GitGuide_V2_image009.png"/>
</div>
<p>If you have chosen Putty as SSH client during TortoiseGit installation, check the <b>Load Putty Key</b> option and specify the location of the private key file saved by PuttyGen (see 3.2.1). This shall be done for the first time only.</p>
<p>Note that on the first connection to the repository server you may be requested to enter a password for your private SSH key; further you can get a message that the authenticity of the host cannot be established and will be asked if you want to continue connecting or not. Choose <b>Yes</b> to continue. The host’s key will be stored in <em>$HOME/.ssh/known_hosts</em> file.</p>
<h2><a class="anchor" id="occt_gitguide_4_3"></a>
Branch creation</h2>
<p>You need to create a branch when you are going to start development of a new change, apply a patch, etc. It is recommended to fetch updates from the remote repository before this operation, to make sure you work with the up-to-date version.</p>
<p>Create a branch from the current master branch unless you need to base your development on a particular version or revision.</p>
<p>In the console:</p>
<div class="fragment"><div class="line">&gt; git checkout -b CR12345 origin/master</div></div><!-- fragment --><p>In TortoiseGit:</p><ul>
<li>Go to the local copy of the repository.</li>
<li>Right-click in the Explorer window, then choose <b>Git Create Branch</b>.</li>
<li>Select <b>Base On</b> Branch <em>remotes/origin/master</em>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image012.png" alt="OCCT_GitGuide_V2_image012.png"/>
</div>
<p>Check option <b>Switch to new branch</b> if you are going to start working with the newly created branch immediately.</p>
<h2><a class="anchor" id="occt_gitguide_4_4"></a>
Branch switching</h2>
<p>If you need to switch to another branch, use Git command checkout for that. In the console:</p>
<div class="fragment"><div class="line">&gt; git checkout CR12345</div></div><!-- fragment --><p>In TortoiseGit: right-click in the explorer window and select in the context menu <b>TortoiseGit</b> -&gt; <b>Switch/Checkout</b>.</p>
<div class="image">
<img src="OCCT_GitGuide_V2_image013.png" alt="OCCT_GitGuide_V2_image013.png"/>
</div>
<p>Note that in order to work with the branch locally you need to set option <b>Create new branch</b> when you checkout the branch from the remote repository for the first time. Option <b>Track</b> stores association between the local branch and the original branch in a remote repository.</p>
<h2><a class="anchor" id="occt_gitguide_4_5"></a>
Committing branch changes</h2>
<p>Commit your changes locally as soon as a stable status of the work is reached. Make sure to review carefully the committed changes beforehand to avoid unintentional commit of a wrong code.</p>
<ul>
<li>In the console:</li>
</ul>
<div class="fragment"><div class="line">&gt; git diff</div><div class="line">…</div><div class="line">&gt; git commit -a -m &quot;Write meaningful commit message here&quot;</div></div><!-- fragment --><p>Option -a tells the command to automatically include (stage) files that have been modified or deleted, but it will omit the new files that might have been added by you. To commit such new files, you must add (stage) them before commit command.</p>
<p>To find new unstaged files and them to commit, use commands:</p>
<div class="fragment"><div class="line">&gt; git status -s</div><div class="line">  ?? file1.hxx </div><div class="line">  ?? file2.cxx</div><div class="line">&gt; git add file1.hxx file2.cxx</div></div><!-- fragment --><ul>
<li>In TortoiseGit: right-click in the explorer window and select in the context menu <b>Git Commit -&gt; CR…</b>:</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image014.png" alt="OCCT_GitGuide_V2_image014.png"/>
</div>
<p>Unstaged files will be shown if you check the option ‘Show Unversioned Files’. Double-click on each modified file to see the changes to be committed (as a difference vs. the base version).</p>
<h2><a class="anchor" id="occt_gitguide_4_6"></a>
Pushing branch to the remote repository</h2>
<p>When the code developed in your local branch is ready for review, or you need to share it with others, push your local changes to the remote repository.</p>
<ul>
<li>In the console:</li>
</ul>
<div class="fragment"><div class="line">&gt; git push &quot;origin&quot; CR12345:CR12345</div></div><!-- fragment --><ul>
<li>In TortoiseGit: right-click in the explorer window and select in the context menu, TortoiseGit -&gt; <b>Push</b></li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image015.png" alt="OCCT_GitGuide_V2_image015.png"/>
</div>
<p>Note that Git forbids pushing a branch if the corresponding remote branch already exists and has some changes, which are not in the history of your local branch. This may happen in different situations:</p><ul>
<li>You have amended the last commit which is already in the remote repository. If you are sure that nobody else uses your branch, push again with <b>Force</b> option.</li>
<li>You have rebased your branch, so that now it is completely different from the branch in the remote repository. In this case, push it under a different name (add a suffix):</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image016.png" alt="OCCT_GitGuide_V2_image016.png"/>
</div>
<p>Then remove the original remote branch so that other people recognize that it has been replaced by the new one. For that, select TortoiseGit -&gt; <b>Push</b> again, select an empty line for your local branch name, and enter the name of the branch to be removed in <b>Remote</b> field:</p>
<ul>
<li>The other developer has committed some changes in the remote branch. In this case, <b>Pull</b> changes from the remote repository to have them merged with your version, and push your branch after it is successfully merged.</li>
</ul>
<h2><a class="anchor" id="occt_gitguide_4_7"></a>
Synchronizing with remote repository</h2>
<p>Maintain your repository synchronized with the remote one and clean unnecessary stuff regularly.</p>
<p>Use Git command <em>fetch</em> with option <em>prune</em> to get the update of all branches from the remote repository and to clean your local repository from the remote branches that have been deleted.</p>
<ul>
<li>In the console: <div class="fragment"><div class="line">&gt; git fetch --prune </div></div><!-- fragment --></li>
<li>In TortoiseGit: right-click in the explorer window and select in the context menu <b>TortoiseGit</b> -&gt; <b>Fetch</b>. Check in <b>Prune</b> check-box.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image018.png" alt="OCCT_GitGuide_V2_image018.png"/>
</div>
<p>If the branch you are working with has been changed in the remote repository, use Git command <em>pull</em> to get the remote changes and merge them with your local branch.</p>
<p>This operation is required in particular to update your local master branch when the remote master changes.</p>
<ul>
<li>In console: <div class="fragment"><div class="line">&gt; git pull</div></div><!-- fragment --></li>
<li>In TortoiseGit: right-click in the explorer window and select in the context menu <b>TortoiseGit</b> -&gt; <b>Pull</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image019.png" alt="OCCT_GitGuide_V2_image019.png"/>
</div>
<p>Note that the local branches of your repository are the primary place, where your changes are stored until they get integrated to the official version of OCCT (master branch). The branches submitted to official repository are for collaborative work, review, and integration &ndash; that repository should not be used for long-term storage of incomplete changes.</p>
<p>Remove the local branches that you do not need any more. Note that you cannot delete the current branch. It means that you need to switch to another one (e.g. master) if the branch you are going to delete is the current one.</p>
<ul>
<li>In the console: <div class="fragment"><div class="line">&gt; git branch -d CR12345</div></div><!-- fragment --></li>
<li>In TortoiseGit: right-click in the explorer window and select in the context menu <b>TortoiseGit</b> -&gt; <b>Git Show Log</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image020.png" alt="OCCT_GitGuide_V2_image020.png"/>
</div>
<p>Select <b>All branches</b> check-box to view all branches. Right-click on the branch you want to delete and select <b>Delete</b> item in the context menu.</p>
<p>Note that many functions described above can be accessed from the Log View, which is a very convenient tool to visualize and manage branches.</p>
<h2><a class="anchor" id="occt_gitguide_4_8"></a>
Applying a fix made on older version of OCCT</h2>
<p>If you have a fix made on a previous version of OCCT, perform the following sequence of operations to prepare it for testing and integration to the current development version:</p><ul>
<li>Identify the version of OCCT on which the fix has been made. In most cases, this will be an OCCT release, e.g. OCCT 6.7.0.</li>
<li>Find a tag or a commit corresponding to this version in the Git history log of the master branch.</li>
<li>Create a branch basing on this tag or commit. In TortoiseGit history log: right-click on the base commit, then select <b>Create branch at this version</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image021.png" alt="OCCT_GitGuide_V2_image021.png"/>
</div>
<ul>
<li>Check option <b>Switch to the new branch</b> to start working within the new branch immediately, or switch to it separately afterwards.</li>
<li>Put your fix in the working copy, build and check that it works, then commit to the branch.</li>
<li>Rebase the branch on the current master. In TortoiseGit: right-click on the working directory, choose <b>TortoiseGit</b> -&gt; <b>Rebase</b>, select <em>remotes/origin/master</em> as UpStream revision, and click <b>Start</b>:</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image022.png" alt="OCCT_GitGuide_V2_image022.png"/>
</div>
<p>Note that you can get some conflicts during rebase. To resolve them, double-click on each conflicted file (highlighted by red in the file list) to open visual merge tool. Switch between conflicting fragments by red arrows, and for each one decide if the code of one or both conflicting versions is to be taken.</p>
<h2><a class="anchor" id="occt_gitguide_4_9"></a>
Rebasing with history clean-up</h2>
<p>At some moments you might need to rebase your branch on the latest version of the master.</p>
<p>We recommend rebasing before the first submission of the branch for review or when the master has diverged substantially from your branch.</p>
<p>Rebasing is a good occasion to clean-up the history of commits in the branch. Consider collapsing (squashing, in terms of Git) the history of your branch into a single commit unless you deem that having separate commits is important for your future work with the branch or its code reviewing. Git also allows changing the order of commits, edit commit contents and messages, etc.</p>
<p>To rebase your branch into a single commit, you need to do the following:</p><ul>
<li>Switch to your branch (e.g. “CR12345”)</li>
<li>In TortoiseGit history log, select a branch to rebase on <em>(remotes/origin/master)</em> and in the context menu choose <b>Rebase “CR12345” onto this</b>.</li>
<li>In the <b>Rebase</b> dialog, check <b>Squash All</b>. You can also change the order of commits and define for each commit whether it should be kept (<b>Pick</b>), edited, or just skipped.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image023.png" alt="OCCT_GitGuide_V2_image023.png"/>
</div>
<ul>
<li>Click <b>Start</b>.</li>
<li>The process will stop if a conflict is detected. In that case, find files with status <b>Conflicted</b> in the list (marked by red), and double-click on them to resolve the conflict. When all conflicts are resolved, click <b>Continue</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image024.png" alt="OCCT_GitGuide_V2_image024.png"/>
</div>
<ul>
<li>At the end of the process, edit the final commit message (it should start from the issue ID and a description from Mantis in the first line, followed by a summary of actual changes), and click <b>Commit</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image025.png" alt="OCCT_GitGuide_V2_image025.png"/>
</div>
<h1><a class="anchor" id="occt_gitguide_5"></a>
Work with repository: Reviewer operations</h1>
<h2><a class="anchor" id="occt_gitguide_5_1"></a>
Review branch changes using GitWeb</h2>
<p>The changes made in the branch can be reviewed without direct access to Git, using GitWeb interface:</p>
<ul>
<li>Open GitWeb in your web browser: <a href="http://git.dev.opencascade.org/gitweb/?p=occt.git">http://git.dev.opencascade.org/gitweb/?p=occt.git</a></li>
<li>Locate the branch you want to review among <b>heads</b> (click ‘…’ at the bottom of the page to see the full list).</li>
<li>Click <b>log</b> (or <b>shortlog</b>) to see the history of the branch.</li>
</ul>
<p><b>Note</b> that the branch can contain more than one commit, and you need to distinguish commits that belong to that branch (those to be reviewed) from the commits corresponding to the previous state of the master branch. Normally the first commit in the list that starts from the ID of the other issue indicates the branching point; commits above it are the ones to be reviewed.</p>
<ul>
<li>Click <b>commitdiff</b> on each log entry to review the changes (highlighted with color format).</li>
</ul>
<h2><a class="anchor" id="occt_gitguide_5_2"></a>
Review branch changes with TortoiseGit</h2>
<p>Use of TortoiseGit is recommended for convenient code review:</p>
<ul>
<li>Fetch the changes from the remote repository as described in <a class="el" href="occt_dev_guides__git_guide.html#occt_gitguide_4_7">Synchronizing with remote repository</a> section.</li>
<li>Right-click on the repository, choose <b>TortoiseGit</b> -&gt; <b>Show</b> log;</li>
<li>Locate the remote branch you need to review;</li>
<li>To review commits one-by-one, select each commit in the log. The list of changed files is shown at the bottom of the window; double-click on the file will open visual compare tool.</li>
<li>To review all changes made in the branch at once, or to compare two arbitrary revisions, select the corresponding commits in the log (e.g. the last commit in the branch and the branching point), ight-click for the context menu, and choose <b>Compare revisions</b>.</li>
</ul>
<div class="image">
<img src="OCCT_GitGuide_V2_image026.png" alt="OCCT_GitGuide_V2_image026.png"/>
</div>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Aug 30 2017 17:08:51 for Open CASCADE Technology by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
